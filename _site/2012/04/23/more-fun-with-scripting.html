<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<title>More Fun With Scripting</title>
	<meta name="description" content="" />
	<meta name="keywords" content="" />
	<link rel="stylesheet" href="/css/reset.css" />
	<link rel="stylesheet" href="/css/style.css?v=1.0" />
	<link rel="stylesheet" href="/css/syntax.css?v=1.0" />
	<link href='http://fonts.googleapis.com/css?family=Varela' rel='stylesheet' type='text/css'>
	<!-- icon -->
    <link rel="icon" type="image/x-icon" href="/image/favicon.ico" />
	<!--[if lt IE 9]>
		<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]--> 
</head>
<body>
	<!-- start header -->
	<header class="group" id="global-header" role="banner">
		<div class="wrapper">
			<h2>Man on a Mission</h2>
			<h4>... stuff, opinion and trivia from life's lucky dip</h4>
		</div>
	</header>
	<!-- end header -->
	<!-- begin navigation -->
	<nav class="group" id="global-nav" role="navigation">
		<div class="wrapper">
			<ul>
				<li><a href="/">Home</a></li>
				<li><a href="/archive.html">Archive</a></li>
				<li><a href="/about.html">About</a></li>
			</ul>
		</div>
	</nav>
	<!-- end navigation -->
		<main class="group" id="global-main" role="main">
		<div class="archive-wrapper">
			<section id="articles" class="post">
				<article>
					<div class="articlepost">
						<header class="post-title">
							<h3>More Fun With Scripting</h3>
							<h5>23 Apr 2012</h5>
						</header>
						<h5 id="using-wmic-to-get-a-list-of-installed-applications">Using WMIC To Get A List Of Installed Applications</h5>

<p>I was asked by a colleague if I knew how to obtain a list of installed applications on a remote workstation without having physical access to the machine. I thought I&#8217;d 
give WMIC a test drive as it looked the simplest method.</p>

<p>After some investigation I came up with a few options which are shown below. All these commands are run from the CMD prompt. Unfortunately the output only shows you the 
applications that have been installed via an MSI file. Anything installed via say a EXE won&#8217;t be displayed. For that you need the registry.</p>

<div class="highlight"><pre><code class="vbnet"><span class="lineno">1</span> <span class="o">/*</span> <span class="n">installed</span> <span class="n">apps</span> <span class="k">on</span> <span class="n">the</span> <span class="n">local</span> <span class="n">machine</span> <span class="o">*/</span>
<span class="lineno">2</span> <span class="n">wmic</span> <span class="o">/</span><span class="n">output</span><span class="p">:</span><span class="n">software_%COMPUTERNAME%</span><span class="p">.</span><span class="n">htm</span> <span class="n">product</span> <span class="k">get</span> <span class="n">Name</span><span class="p">,</span> <span class="n">Version</span> <span class="o">/</span><span class="n">format</span><span class="p">:</span><span class="n">htable</span><span class="p">.</span><span class="n">xsl</span>
<span class="lineno">3</span> 
<span class="lineno">4</span> <span class="o">/*</span> <span class="n">installed</span> <span class="n">apps</span> <span class="k">on</span> <span class="n">a</span> <span class="k">single</span> <span class="n">remote</span> <span class="n">machine</span> <span class="o">*/</span>
<span class="lineno">5</span> <span class="n">wmic</span> <span class="o">/</span><span class="n">node</span><span class="p">:</span><span class="n">PCNAME</span> <span class="o">/</span><span class="n">output</span><span class="p">:</span><span class="n">software_PCNAME</span><span class="p">.</span><span class="n">htm</span> <span class="n">product</span> <span class="k">get</span> <span class="n">Name</span><span class="p">,</span> <span class="n">Version</span> <span class="o">/</span><span class="n">format</span><span class="p">:</span><span class="n">htable</span><span class="p">.</span><span class="n">xsl</span>
<span class="lineno">6</span> 
<span class="lineno">7</span> <span class="o">/*</span> <span class="n">installed</span> <span class="n">apps</span> <span class="k">on</span> <span class="n">multiple</span> <span class="n">remote</span> <span class="n">machines</span> <span class="o">*/</span>
<span class="lineno">8</span> <span class="n">wmic</span> <span class="o">/</span><span class="n">node</span><span class="p">:</span><span class="err">@</span><span class="n">workstation</span><span class="p">.</span><span class="n">txt</span> <span class="o">/</span><span class="n">output</span><span class="p">:</span><span class="n">software</span><span class="p">.</span><span class="n">htm</span> <span class="n">product</span> <span class="k">get</span> <span class="n">Name</span><span class="p">,</span> <span class="n">Version</span> <span class="o">/</span><span class="n">format</span><span class="p">:</span><span class="n">htable</span><span class="p">.</span><span class="n">xsl</span>
</code></pre></div>

<p>In the examples above the output is to an HTML file using the /format switch and the htable.xls (style sheet). There are other options such as csv and xml. In the last 
option the file workstation.txt is a file containing the list of workstations you want to target, either comma separated or 1 per line.</p>

<p>There is a BUG in Windows 7 which may result in you getting an error about not being able to find the XLS file. To correct this you need to add this to the PATH 
variable - <strong>C:\Windows\System32\wbem\en-US</strong> - to allow WMIC to find the XLS files. In Windows XP they&#8217;re in the <strong>C:\Windows\System32</strong> folder and there should be no 
errors. One other point to note, especially with regards to example 3, is that this method is very slow.</p>

<h5 id="running-cmd-as-administrator">Running CMD As Administrator</h5>

<p>I found this very small but extremely useful bit of information to allow you to run the CMD prompt as administrator - <strong>runas /user:DOMAINUSERID@DOMAIN cmd</strong> - this has 
saved me on more than one occasion.</p>

<h5 id="php-sessionstart-warning-fixed">PHP session_start() Warning Fixed</h5>

<p>After a PHP upgrade my site was giving the following error</p>

<blockquote>
  <p>Warning: session_start() [function.session-start]: SAFE MODE Restriction in effect. The script whose uid is 795 is not allowed to access /tmp owned by uid 0 in 
/home/foo/bar/index.php on line 9<br />Fatal error: session_start() [function.session-start]: Failed to initialize storage module: files (path: ) in /home/foo/bar/index.php on line 9</p>
</blockquote>

<p>I logged a support ticket with my Host however I was able to fix it by adding the following to my custom <strong>php.ini</strong> file</p>

<div class="highlight"><pre><code class="vbnet"><span class="lineno">1</span> <span class="err">;</span>
<span class="lineno">2</span> <span class="err">;</span> <span class="n">Sessions</span>
<span class="lineno">3</span> <span class="n">session</span><span class="p">.</span><span class="n">save_path</span> <span class="o">=</span> <span class="s">&quot;/tmp&quot;</span>
<span class="lineno">4</span> <span class="err">;</span>
</code></pre></div>

					</div>
				</article>
			</section>
		</div>
	</main>
	<!-- start footer -->
	<footer class="group" id="global-footer" role="contentinfo">
		<div class="wrapper">
			<h4>Words &amp; Pictures Copyright Â© 2008-2014 Steven Dobson unless otherwise stated</h4>
			<h4>Hosted on <a href="https://github.com/" title="GitHub" >GitHub</a> assisted by <a href="http://jekyllrb.com/" title="Jekyll" >Jekyll</a></h4>
		</div>
	</footer>
	<!-- end footer -->
</body>
</html>